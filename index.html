<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Home</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" media="screen" href="index.css" />
    
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

    <script>
        const contract_address = "0x5abF799Fb0897fbD1a5DB323C1BEF90dcFC7bd22";
        const abi = [
            {
            "constant": true,
            "inputs": [],
            "name": "artigosCount",
            "outputs": [
                {
                "name": "",
                "type": "uint256"
                }
            ],
            "payable": false,
            "stateMutability": "view",
            "type": "function"
            },
            {
            "constant": true,
            "inputs": [],
            "name": "owner",
            "outputs": [
                {
                "name": "",
                "type": "address"
                }
            ],
            "payable": false,
            "stateMutability": "view",
            "type": "function"
            },
            {
            "constant": true,
            "inputs": [
                {
                "name": "",
                "type": "uint256"
                }
            ],
            "name": "artigos",
            "outputs": [
                {
                "name": "id",
                "type": "uint256"
                },
                {
                "name": "titulo",
                "type": "string"
                },
                {
                "name": "corpo",
                "type": "string"
                },
                {
                "name": "autor",
                "type": "address"
                },
                {
                "name": "versao",
                "type": "uint256"
                }
            ],
            "payable": false,
            "stateMutability": "view",
            "type": "function"
            },
            {
            "inputs": [],
            "payable": false,
            "stateMutability": "nonpayable",
            "type": "constructor"
            },
            {
            "constant": false,
            "inputs": [
                {
                "name": "_titulo",
                "type": "string"
                },
                {
                "name": "_corpo",
                "type": "string"
                }
            ],
            "name": "adicionaArtigo",
            "outputs": [],
            "payable": false,
            "stateMutability": "nonpayable",
            "type": "function"
            },
            {
            "constant": false,
            "inputs": [
                {
                "name": "_id",
                "type": "uint256"
                },
                {
                "name": "_titulo",
                "type": "string"
                },
                {
                "name": "_corpo",
                "type": "string"
                }
            ],
            "name": "alterarArtigo",
            "outputs": [],
            "payable": false,
            "stateMutability": "nonpayable",
            "type": "function"
            },
            {
            "constant": true,
            "inputs": [
                {
                "name": "id",
                "type": "uint256"
                }
            ],
            "name": "getArtigo",
            "outputs": [
                {
                "name": "",
                "type": "uint256"
                },
                {
                "name": "",
                "type": "string"
                }
            ],
            "payable": false,
            "stateMutability": "view",
            "type": "function"
            }
        ]

        let contract;

        var version = web3.version.api;
        console.log('versao: ', version); // "0.2.0"

        function main() {
            contract = web3.eth.contract(abi).at(contract_address);
            console.log('contrato: ', contract)

            //console.log('argumentos: ' , contract.artigos.arguments)
            //teste = contract.artigos.call(1).then((result) => {
            //    $('#message').text(result[1].toString())
            //}) //$('#message').text(result[1]);
            
            var o = 1
            o = o.toString(16)
            teste = contract.getArtigo(o, (err, result) => {
                console.log('resultado: ', err)
            })
        }

        window.addEventListener('load', () => {
            if(typeof(web3) === 'undefined') {
                return console.log("Metamask is not installed.");
            }

            main()
                //.then(() => {console.log('foi')})
                //.catch((err) => {console.log('erro:', err)})
        });

       
    </script>

</head>
<body class="body">
    <nav class="nav-margin">
        <ul class="nav nav-pills">
            <li role="presentation" >
                <a class="nav-link" href="index.html" role="button" aria-haspopup="true" aria-expanded="false">
                    Home
                </a>
            </li>
            <li role="presentation" >
                <a class="nav-link" href="my-pages.html" role="button" aria-haspopup="true" aria-expanded="false">
                    My Pages and Contributions
                </a>
            </li>
        </ul>
    </nav>

    <div class="flexbox general-margin"> 
        <div class="panel panel-warning">
            <div class="panel-heading">
                <h3 class="panel-header">Last Page Title</h3>
            </div>

            <div class="panel-body flexbox content">
                <div class="content-text">
                    <div id="message"></div>
                <div class="img">
                    <img class="img-fluid" src="eye.jpg">
                    <p class="img-desc">Aenean fermentum lobortis lobortis. Phasellus ut egestas massa. Orci varius natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec tincidunt est at turpis blandit, non gravida nisi consectetur. Maecenas ullamcorper aliquam interdum.</p>
                </div>
            </div>            
        </div>
    </div>

    <div class="flexbox general-margin"> 
        <div class="panel panel-warning table-panel">
            <div class="panel-heading">
                <h3 class="panel-header">All Pages</h3>
            </div>

            <div class="panel-body flexbox content">
                <div class="content-text content-table">
                    <table class="table">
                        <thead>
                            <tr>
                                <th class="button-cell"></th>
                                <th>Page Title</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td class="button-cell"><button class="button"><a href="edit.html">Edit</a></button></td>
                                <td class="page-title-cell"><a href="page.html">Page Title</a></td>
                            </tr>
                            <tr>
                                <td class="button-cell"><button class="button"><a href="edit.html">Edit</a></button></td>
                                <td class="page-title-cell"><a href="page.html">Page Title</a></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>            
        </div>
    </div>
</body>


</html>